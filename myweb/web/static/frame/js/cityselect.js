(function(a){a.fn.citySelect=function(d){if(this.length<1){return}d=a.extend({url:"city.min.js",prov:"北京",city:"东城区",dist:null,nodata:null,required:false},d);var f=this;var c=f.find(".prov");var n=f.find(".city");var m=f.find(".dist");var l=d.prov;var i=d.city;var h=d.dist;var b=(d.required)?"":"<option value=''>请选择</option>";var g;var k=function(){var o=c.get(0).selectedIndex;if(!d.required){o--}n.empty().attr("disabled",true);m.empty().attr("disabled",true);if(o<0||typeof(g.citylist[o].c)=="undefined"){if(d.nodata=="none"){n.css("display","none");m.css("display","none")}else{if(d.nodata=="hidden"){n.css("visibility","hidden");m.css("visibility","hidden")}}return}temp_html=b;a.each(g.citylist[o].c,function(p,q){temp_html+="<option value='"+q.n+"'>"+q.n+"</option>"});n.html(temp_html).attr("disabled",false).css({display:"",visibility:""});e();a(".selectpicker").selectpicker("refresh")};var e=function(){var o=c.get(0).selectedIndex;var p=n.get(0).selectedIndex;if(!d.required){o--;p--}m.empty().attr("disabled",true);if(o<0||p<0||typeof(g.citylist[o].c[p].a)=="undefined"){if(d.nodata=="none"){m.css("display","none")}else{if(d.nodata=="hidden"){m.css("visibility","hidden")}}return}temp_html=b;a.each(g.citylist[o].c[p].a,function(q,r){temp_html+="<option value='"+r.s+"'>"+r.s+"</option>"});m.html(temp_html).attr("disabled",false).css({display:"",visibility:""})};var j=function(){temp_html=b;a.each(g.citylist,function(p,o){temp_html+="<option value='"+o.p+"'>"+o.p+"</option>"});c.html(temp_html);setTimeout(function(){if(d.prov!=null){c.val(d.prov);k();setTimeout(function(){if(d.city!=null){n.val(d.city);e();setTimeout(function(){if(d.dist!=null){m.val(d.dist)}},1)}},1)}},1);c.bind("change",function(){k()});n.bind("change",function(){e()})};if(typeof(d.url)=="string"){a.getJSON(d.url,function(o){g=o;j()})}else{g=d.url;j()}}})(jQuery);
